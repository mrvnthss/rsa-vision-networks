# @package _global_

# This configuration file can be used to run a grid search on the
# batch size and learning rate parameters used to train the LeNet-5
# model on the FashionMNIST dataset.
#
# To run this experiment, execute the following command from the
# "thesis-experiments/src/" directory:
#
#   >>> python train_classifier.py experiment=lenet_fashionmnist/grid_search/batch_size_lr
#


# Multi-run configuration
experiment:
  name: lenet_fashionmnist/grid_search/batch_size_lr
  dir:  ../out/${experiment.name}/${now:%Y-%m-%d_%H-%M-%S}
  sub_dir: b=${dataloader.batch_size},lr=${optimizer.kwargs.lr}
paths:
  checkpoints: ${experiment.dir}/${experiment.sub_dir}/checkpoints
  tensorboard: ${experiment.dir}/${experiment.sub_dir}/tensorboard
hydra:
  mode: MULTIRUN
  sweep:
    dir: ${experiment.dir}
    subdir: ${experiment.sub_dir}/logs
  sweeper:
    params:
      # Grid search parameters
      dataloader.batch_size: 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096
      optimizer.kwargs.lr: 0.1, 0.01, 0.001

# Fixed training parameters
reproducibility:
  torch_seed: 89
  shuffle_seed: 858
dataset:
  transform_params:
    resize_size: ${model.input_size}  # matches the input size of the model
dataloader:
  num_workers: 0
optimizer:
  kwargs:
    momentum: 0.9
    weight_decay: 1e-4
performance:
  patience: 5
